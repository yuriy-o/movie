"use strict";(self.webpackChunkmovies_db=self.webpackChunkmovies_db||[]).push([[551],{1551:(e,n,t)=>{t.r(n),t.d(n,{default:()=>D});var o=t(2791),i=t(1889),s=t(9164),r=t(890),l=t(7482),a=t(7749);var d=t(3199),c=t(5527),u=t(8096),x=t(5904),h=t(8615),m=t(7047),v=t(7133),p=t(9012),g=t(5523),j=t(9174),Z=t(4294),f=t(2672),b=t(1134),y=t(9188),k=t(184);function w(e){let{onApply:n}=e;const{control:t,handleSubmit:i,formState:s}=(0,b.cI)({defaultValues:{keywords:[],genres:[]}}),[r,l]=(0,o.useState)(""),{data:a=[],isLoading:w}=(0,y.TF)(r,{skip:!r}),{data:C,isLoading:A}=(0,y._)(),I=(0,o.useMemo)((()=>(0,d.Z)((e=>{l(e)}),1e3)),[]);return(0,k.jsx)(c.Z,{sx:{m:2,p:.5,maxWidth:350},children:(0,k.jsxs)("form",{onSubmit:i(n),children:[(0,k.jsx)(u.Z,{sx:{m:2,display:"block"},component:"fieldset",variant:"standard",children:(0,k.jsx)(b.Qr,{name:"keywords",control:t,render:e=>{let{field:{onChange:n,value:t}}=e;return(0,k.jsx)(x.Z,{multiple:!0,loading:w,disablePortal:!0,options:a,filterOptions:e=>e,getOptionLabel:e=>e.name,onChange:(e,t)=>n(t),value:t,isOptionEqualToValue:(e,n)=>e.id===n.id,onInputChange:(e,n)=>I(n),renderInput:e=>(0,k.jsx)(h.Z,{...e,label:"Keywords"})})}})}),(0,k.jsx)(u.Z,{sx:{m:2,display:"block"},component:"fieldset",variant:"standard",children:A?(0,k.jsx)(m.Z,{width:300,height:480}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(v.Z,{component:"legend",children:"Genres"}),(0,k.jsx)(p.Z,{sx:{maxHeight:500},children:(0,k.jsx)(b.Qr,{name:"genres",control:t,render:e=>{let{field:n}=e;return(0,k.jsx)(k.Fragment,{children:null===C||void 0===C?void 0:C.map((e=>(0,k.jsx)(g.Z,{control:(0,k.jsx)(j.Z,{value:e.id,checked:n.value.includes(e.id),onChange:(e,t)=>{const o=Number(e.target.value);t?n.onChange([...n.value,o]):n.onChange(n.value.filter((e=>e!==o)))}}),label:e.name},e.id)))})}})})]})}),(0,k.jsx)(Z.Z,{type:"submit",sx:{m:2},variant:"contained",startIcon:(0,k.jsx)(f.Z,{}),disabled:!s.isDirty,children:"Apply filter"})]})})}var C=t(7621),A=t(2169),I=t(9504),P=t(2363),F=t(68),S=t(3400),M=t(7237),O=t(1087);function T(e){let{id:n,title:t,overview:o,popularity:i,onAddToFavorite:s,image:l="/movie-thumb.png",enableUserActions:a=!1}=e;return console.count("MovieCard"),(0,k.jsxs)(C.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,k.jsx)(A.Z,{component:"div",sx:{pt:"56.25%"},image:l}),(0,k.jsxs)(I.Z,{sx:{flexGrow:1},children:[(0,k.jsx)(r.Z,{gutterBottom:!0,variant:"h5",component:"h2",children:t}),(0,k.jsx)(r.Z,{variant:"body2",color:"text.secondary",children:o}),(0,k.jsx)(r.Z,{variant:"button",display:"block",mt:2,children:i})]}),(0,k.jsxs)(P.Z,{children:[(0,k.jsx)(Z.Z,{component:O.rU,to:"/movies/".concat(n),color:"secondary",children:"Details"}),a&&(0,k.jsx)(F.Z,{title:"Add to favorites",children:(0,k.jsx)(S.Z,{onClick:()=>null===s||void 0===s?void 0:s(n),children:(0,k.jsx)(M.Z,{})})})]})]})}const _=(0,o.memo)(T),U={page:1,filters:{}};const D=function(){const[e,n]=(0,o.useState)(U),{data:t}=(0,y.T7)(),{data:d,isFetching:c}=(0,y.U9)(e),u=null===d||void 0===d?void 0:d.results,x=null===d||void 0===d?void 0:d.hasMorePages,h=(0,o.useContext)(a.V),m=h.user!==a.O,v=(0,o.useCallback)((()=>{x&&n((e=>({...e,page:e.page+1})))}),[x]),[p]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{threshold:n=1,root:t=null,rootMargin:i="0px",onIntersect:s}=e,r=(0,o.useRef)(null),[l,a]=(0,o.useState)();return(0,o.useEffect)((()=>{const e=new IntersectionObserver((e=>{const[n]=e;n.isIntersecting&&(null===s||void 0===s||s()),a(n)}),{threshold:n,root:t,rootMargin:i}),o=r.current;return o&&e.observe(o),function(){o&&e.disconnect()}}),[s,t,i,n]),[r,l]}({onIntersect:v}),g=(0,o.useCallback)((e=>alert("Not implemented! Action: ".concat(h.user.name," is adding movie ").concat(e," to favorites."))),[h.user.name]);return(0,k.jsxs)(i.ZP,{container:!0,spacing:2,sx:{flexWrap:"nowrap"},children:[(0,k.jsx)(i.ZP,{item:!0,xs:"auto",children:(0,k.jsx)(w,{onApply:e=>{const t={keywords:null===e||void 0===e?void 0:e.keywords.map((e=>e.id)),genres:null===e||void 0===e?void 0:e.genres};n({page:1,filters:t})}})}),(0,k.jsx)(i.ZP,{item:!0,xs:12,children:(0,k.jsxs)(s.Z,{sx:{py:8},maxWidth:"lg",children:[!c&&!(null!==u&&void 0!==u&&u.length)&&(0,k.jsx)(r.Z,{variant:"h6",children:"No movies were found that match your query."}),(0,k.jsx)(i.ZP,{container:!0,spacing:4,children:null===u||void 0===u?void 0:u.map(((e,n)=>{return(0,k.jsx)(i.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(_,{id:e.id,title:e.title,overview:e.overview,popularity:e.popularity,image:(o=e.backdrop_path,o&&t?"".concat(t.images.base_url,"w780").concat(o):void 0),enableUserActions:m,onAddToFavorite:g},e.id)},e.id);var o}))}),(0,k.jsx)("div",{ref:p,children:c&&(0,k.jsx)(l.Z,{color:"secondary",sx:{mt:3}})})]})})]})}}}]);
//# sourceMappingURL=551.9545c80a.chunk.js.map